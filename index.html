<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Musical Boxing Machine</title>    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>    <style>        body {            font-family: Arial, sans-serif;            text-align: center;            background-color: #222;            color: white;        }        .container {            max-width: 900px;            margin: auto;            padding: 20px;            background: #333;            border-radius: 10px;        }        button, select {            padding: 10px;            margin: 5px;            font-size: 16px;        }        .piezo-section {            margin-top: 20px;            padding: 15px;            background-color: #444;            border-radius: 8px;        }        table {            width: 100%;            margin-top: 20px;            border-collapse: collapse;        }        th, td {            border: 1px solid white;            padding: 8px;        }        canvas {            margin-top: 20px;        }    </style></head><body>
<div class="container">    <h2>Boxing Machine - Force Sensor</h2>        <button onclick="connectBluetooth()">Connect Bluetooth</button>    <select id="deviceList"></select>    <button onclick="muteSound()">Mute Sound</button>        <!-- Piezometer Sections -->    <div id="piezometer1" class="piezo-section">        <h3>Piezometer 1</h3>        <h4>Live Force: <span id="forceDisplay1">0</span> kg</h4>        <canvas id="forceChart1"></canvas>        <h4>Past Readings</h4>        <table>            <thead>                <tr>                    <th>Time</th>                    <th>Force (kg)</th>                </tr>            </thead>            <tbody id="historyTable1"></tbody>        </table>    </div>
    <div id="piezometer2" class="piezo-section">        <h3>Piezometer 2</h3>        <h4>Live Force: <span id="forceDisplay2">0</span> kg</h4>        <canvas id="forceChart2"></canvas>        <h4>Past Readings</h4>        <table>            <thead>                <tr>                    <th>Time</th>                    <th>Force (kg)</th>                </tr>            </thead>            <tbody id="historyTable2"></tbody>        </table>    </div>
    <div id="piezometer3" class="piezo-section">        <h3>Piezometer 3</h3>        <h4>Live Force: <span id="forceDisplay3">0</span> kg</h4>        <canvas id="forceChart3"></canvas>        <h4>Past Readings</h4>        <table>            <thead>                <tr>                    <th>Time</th>                    <th>Force (kg)</th>                </tr>            </thead>            <tbody id="historyTable3"></tbody>        </table>    </div>
    <div id="piezometer4" class="piezo-section">        <h3>Piezometer 4</h3>        <h4>Live Force: <span id="forceDisplay4">0</span> kg</h4>        <canvas id="forceChart4"></canvas>        <h4>Past Readings</h4>        <table>            <thead>                <tr>                    <th>Time</th>                    <th>Force (kg)</th>                </tr>            </thead>            <tbody id="historyTable4"></tbody>        </table>    </div></div>
<script>let charts = [], forceData = [], muteState = false;
// Connect Bluetooth and retrieve data from ESP32async function connectBluetooth() {    try {        const device = await navigator.bluetooth.requestDevice({            acceptAllDevices: true,            optionalServices: ['battery_service']        });
        document.getElementById('deviceList').innerHTML = `<option>${device.name || 'Unknown'}</option>`;
        const server = await device.gatt.connect();        const service = await server.getPrimaryService('battery_service');        const characteristic = await service.getCharacteristic('battery_level');
        characteristic.addEventListener('characteristicvaluechanged', handleData);        await characteristic.startNotifications();    } catch (error) {        alert("Bluetooth Error: " + error);    }}
// Handle incoming data and update graphs & valuesfunction handleData(event) {    let adcValue = event.target.value.getUint8(0);
    let voltage = (adcValue / 4095) * 3.3;    let forceKg = (voltage - 0.1) / 0.02; // Adjust scale factor
    for (let i = 1; i <= 4; i++) {        document.getElementById(`forceDisplay${i}`).innerText = forceKg.toFixed(2);        let now = new Date().toLocaleTimeString();        document.getElementById(`historyTable${i}`).innerHTML += `<tr><td>${now}</td><td>${forceKg.toFixed(2)} kg</td></tr>`;
        forceData[i - 1].push({ x: now, y: forceKg });        if (forceData[i - 1].length > 10) forceData[i - 1].shift();        charts[i - 1].update();    }}
// Mute sound on ESP32function muteSound() {    muteState = !muteState;    fetch(`http://your-esp32-ip/mute?state=${muteState ? '1' : '0'}`)        .then(response => response.text())        .then(data => alert(muteState ? "Sound Muted!" : "Sound Unmuted!"));}
// Initialize chartsdocument.addEventListener("DOMContentLoaded", function() {    for (let i = 1; i <= 4; i++) {        let ctx = document.getElementById(`forceChart${i}`).getContext("2d");        charts[i - 1] = new Chart(ctx, {            type: "line",            data: {                datasets: [{                    label: `Force (kg) Piezometer ${i}`,                    data: forceData[i - 1] || [],                    borderColor: "lime",                    backgroundColor: "rgba(0,255,0,0.2)"                }]            },            options: {                scales: {                    x: { type: "linear" },                    y: { beginAtZero: true }                }            }        });        forceData[i - 1] = [];    }});</script>
</body></html>
